\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{geometry}
\geometry{margin=1in}
\usepackage{tikz}
\usepackage{hyperref}
\usepackage{enumitem}

\title{Equivariant Structured Positional Rotations:\\Complete Algebraic Derivation}
\author{}
\date{}

\newcommand{\eqdef}{\overset{\varnothing}{=}}
\newcommand{\ProofBlock}[3]{%
  \begin{equation*}
    \boxed{[#1]}\;
    \begin{aligned}[t]
      #2
    \end{aligned}
    \qquad [\mathrm{deps}: #3]
  \end{equation*}
}
\newcommand{\Note}[1]{\text{(#1)}}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Complex}{\mathbb{C}}

\begin{document}

\maketitle

\begin{abstract}
This document provides a complete, boxed derivation of the relative-position property for equivariant structured positional rotations in attention mechanisms.  Each step is recorded as a labelled statement \([T\cdot]\) with explicit dependencies so that the argument can be followed mechanically.
\end{abstract}

\tableofcontents
\newpage

\section{Tier 0: Linear-Algebra Primitives}

\ProofBlock{T0.1:\mathbb{N},\mathrm{Idx}}{
\mathbb{N} \eqdef \{1,2,3,\dots\}\\
d_h,d_c,D \in \mathbb{N}\\
H \eqdef \{1,\dots,d_h\},\quad
K \eqdef \{1,\dots,d_c\},\quad
J_D \eqdef \{1,\dots,D\}
}{\varnothing}

\ProofBlock{T0.2:I_n,\delta_{ij}}{
\delta_{ij} \eqdef
\begin{cases}
1,& i=j,\\
0,& i\neq j,
\end{cases}\\
I_n \eqdef [\delta_{ij}]_{i,j=1}^n
}{T0.1}

\ProofBlock{T0.3:\mathbb{R}^{m\times n},(\cdot)^\top,(\cdot)^*,\mathrm{tr}}{
\Real^{m\times n} \eqdef \text{set of } m\times n \text{ real matrices}\\
\Complex^{m\times n} \eqdef \text{set of } m\times n \text{ complex matrices}\\
A^\top \in \Real^{n\times m} \quad (A\in \Real^{m\times n})\\
B^* \eqdef \overline{B}^{\top} \quad (B\in \Complex^{m\times n})\\
\operatorname{tr}(M) \eqdef \sum_{i=1}^n M_{ii} \quad (M\in \Complex^{n\times n})
}{T0.1}

\ProofBlock{T0.4:\det}{
\det : \Complex^{n\times n}\to\Complex\\
\det(AB)=\det(A)\det(B)\\
\det(A^\top)=\det(A)\\
U\text{ invertible} \Rightarrow \det(UAU^{-1})=\det(A)\\
\Note{multiplicativity, transpose invariance, similarity invariance}
}{T0.3}

\ProofBlock{T0.5:\oplus,\mathrm{blk},\det\oplus}{
\bigoplus_{u=1}^m M_u \eqdef \mathrm{diag}(M_1,\dots,M_m)\\
\det\!\left(\bigoplus_{u=1}^m M_u\right) = \prod_{u=1}^m \det(M_u)\\
\Note{block triangular matrices have determinant equal to product of block determinants}
}{T0.4}

\ProofBlock{T0.6:O,SO,U}{
O(n) \eqdef \{Q\in\Real^{n\times n} \mid Q^\top Q = I_n\}\\
SO(n) \eqdef \{Q\in O(n) \mid \det Q = 1\}\\
U(n) \eqdef \{W\in\Complex^{n\times n} \mid W^*W = I_n\}\\
Q\in O(n) \Rightarrow Q^{-1} = Q^\top
}{T0.2,T0.3,T0.4}

\ProofBlock{T0.7:\det O}{
Q\in O(n) \Rightarrow (\det Q)^2 = \det(Q^\top Q) = \det(I_n)=1\\
\Rightarrow \det Q \in \{\pm 1\}
}{T0.6,T0.4}

\ProofBlock{T0.8:\sigma,\sigma_{\min},\text{normal}}{
\sigma(M) \eqdef \{\lambda\in\Complex \mid \exists x\neq 0: Mx=\lambda x\}\\
M^*M = MM^* \Rightarrow M \text{ normal}\\
\text{Singular values } s_i(M) \eqdef \sqrt{\sigma_i(M^*M)}\\
\sigma_{\min}(M) \eqdef \min_i s_i(M)\\
M \text{ normal} \Rightarrow s_i(M)=|\lambda_i| \text{ for } \lambda_i \in \sigma(M)\\
\Note{unitary diagonalisation of normal matrices}
}{T0.3}

\ProofBlock{T0.9:|\cdot|,|\cdot|_1}{
|x| \eqdef \left(\sum_{u} x_u^2\right)^{1/2} \quad (x\in\Real^m)\\
|x|_1 \eqdef \sum_{u} |x_u|\\
|M| \eqdef \sup_{v\neq 0}\frac{|Mv|}{|v|} \quad (M\in\Real^{m\times n})\\
|AB|\le |A|\,|B|,\quad |A+B|\le |A|+|B|\\
|a| \eqdef \lvert a\rvert \quad (a\in\Real)\\
\Note{overloaded notation chooses scalar, vector, or operator norm from context}
}{T0.8}

\ProofBlock{T0.10:[A,B]}{
[A,B] \eqdef AB-BA
}{T0.3}

\ProofBlock{T0.11:\exp,\log,\exp\text{ props}}{
\exp(M) \eqdef \sum_{t\ge 0}\frac{1}{t!}M^t\\
\log(X) \text{ locally defined as } \exp^{-1}(X) \text{ near } I_n\\
[A,B]=0 \Rightarrow \exp(A+B)=\exp(A)\exp(B)\\
(\exp M)^\top = \exp(M^\top)\\
U \text{ invertible} \Rightarrow \exp(UMU^{-1})=U\exp(M)U^{-1}\\
\det(\exp M)=\exp(\operatorname{tr} M)\\
\exp\!\left(\bigoplus_{u=1}^m M_u\right) = \bigoplus_{u=1}^m \exp(M_u)\\
\Note{all properties follow from the power-series definition}
}{T0.3,T0.4,T0.5,T0.10}

\ProofBlock{T0.12:\mathcal{C},O(\cdot),\approx_\varepsilon}{
\mathcal{C} \eqdef \{C,C',C'',\dots \mid C\ge 0 \text{ finite constants}\}\\
f = O(g) \Leftrightarrow \exists C\in\mathcal{C}: f\le Cg\\
X \approx_\varepsilon Y \Leftrightarrow |X-Y|\le \varepsilon
}{T0.9}

\ProofBlock{T0.13:\mathrm{BCH}}{
\exp(M)\exp(N) = \exp\!\left(M+N+\tfrac12[M,N]+R(M,N)\right)\\
|R(M,N)| = O(|[M,N]|^2)\\
\Note{Baker--Campbell--Hausdorff series (local version)}
}{T0.11,T0.10,T0.12,T0.9}

\ProofBlock{T0.14:\ker,\mathrm{im},\mathrm{rank}}{
\ker(M) \eqdef \{x \mid Mx=0\}\\
\mathrm{im}(M) \eqdef \{Mx \mid x\}\\
\mathrm{rank}(M) \eqdef \dim(\mathrm{im}(M))
}{T0.3,T0.1}

\ProofBlock{T0.15:\mathrm{proj}}{
P^2 = P \text{ and } P^\top = P \Rightarrow P \text{ orthogonal projector}\\
P,Q \text{ orthogonal projectors and } PQ=0 \Rightarrow \mathrm{im}(P)\perp \mathrm{im}(Q)\\
\Note{characterisation via images}
}{T0.14,T0.3}

\ProofBlock{T0.16:\mathrm{skew}_\mathrm{spec}}{
S^\top = -S \Rightarrow S \text{ normal}\\
\sigma(S)\subset i\Real\\
\lambda = i\mu \in \sigma(S) \Rightarrow -\lambda = -i\mu \in \sigma(S)\\
\Note{skew-symmetric spectra occur in conjugate-sign pairs}
}{T0.3,T0.8}

\ProofBlock{T0.17:J,R_2}{
J \eqdef
\begin{bmatrix}
0 & -1\\
1 & 0
\end{bmatrix},\qquad
R_2(\theta) \eqdef \exp(\theta J)
}{T0.11}

\ProofBlock{T0.18:R_2\in SO(2)}{
R_2(\theta)^\top R_2(\theta) = I_2\\
\det R_2(\theta) = 1\\
\Rightarrow R_2(\theta)\in SO(2)\\
\Note{uses $J^\top=-J$ and properties of $\exp$ and the determinant}
}{T0.17,T0.16,T0.11,T0.6,T0.4,T0.7}

\ProofBlock{T0.19:\mathrm{Weyl}}{
\bigl|\sigma_{\min}(A+E) - \sigma_{\min}(A)\bigr| \le |E|
}{T0.8,T0.9}

\ProofBlock{T0.20:(X^{-1})^\top}{
X \text{ invertible } \Rightarrow (X^{-1})^\top = (X^\top)^{-1}
}{T0.3}

\section{Tier 1: Structured Generators}

\ProofBlock{T1.1:L_k}{
\forall k\in K:\ L_k \in \Real^{d_h\times d_h},\quad L_k^\top = -L_k,\quad [L_a,L_b]=0\\
\Note{model hypothesis: commuting skew-symmetric generators}
}{T0.1,T0.3,T0.10,T0.16}

\ProofBlock{T1.2:\mathrm{normal}\ L_k}{
L_k^\top = -L_k \Rightarrow L_k \text{ normal}
}{T1.1,T0.16}

\ProofBlock{T1.3:A(r)}{
r\in \Real^{d_c} \Rightarrow A(r) \eqdef \sum_{k=1}^{d_c} r_k L_k
}{T1.1,T0.1}

\ProofBlock{T1.4:A(r)^\top}{
A(r)^\top = -A(r)
}{T1.3,T1.1,T0.3}

\ProofBlock{T1.5:[A(r),A(s)]}{
[A(r),A(s)] = 0
}{T1.3,T1.1,T0.10}

\ProofBlock{T1.6:R_{\mathrm{STR}}}{
R_{\mathrm{STR}}(r) \eqdef \exp(A(r))
}{T1.3,T0.11}

\section{Tier 2: Joint Block Structure}

\ProofBlock{T2.1:\mathrm{sim}\text{-}\mathrm{unitary}}{
\{L_k\}_{k\in K} \text{ commute and are normal}\\
\Rightarrow \exists \mathcal{U}_c \in U(d_h):\ \mathcal{U}_c^* L_k \mathcal{U}_c = \mathrm{diag}(i\lambda_{k,1},\dots,i\lambda_{k,d_h})\\
\lambda_{k,j}\in\Real
}{T1.2,T1.1,T0.6,T0.16}

\ProofBlock{T2.2:\mathrm{real}\ 2\text{D}\ \mathrm{planes}}{
\text{Fix } j\in H:\ \mathcal{U}_c^*L_k\mathcal{U}_c e_j = i\lambda_{k,j} e_j\\
\Rightarrow L_k(\Re e_j) = \lambda_{k,j} J (\Re e_j,\Im e_j)\\
L_k(\Im e_j) = \lambda_{k,j} J (\Re e_j,\Im e_j)\\
\Rightarrow \mathrm{span}\{\Re e_j,\Im e_j\} \text{ is a real, }2\text{-D, }L_k\text{-invariant plane}
}{T2.1,T0.17,T0.16,T0.3}

\ProofBlock{T2.3:\mathrm{JointBlockDiag}}{
\exists m,d_{\mathrm{null}}\in\mathbb{N}:\ 2m+d_{\mathrm{null}}=d_h\\
\exists U\in O(d_h):\ U^\top L_k U
 = \left(\bigoplus_{u=1}^m \lambda_{k,u} J\right)\oplus 0_{d_{\mathrm{null}}\times d_{\mathrm{null}}}
}{T2.2,T0.6,T0.16,T0.5}

\ProofBlock{T2.4:\beta,\theta}{
\beta_u \eqdef (\lambda_{1,u},\dots,\lambda_{d_c,u})^\top \in \Real^{d_c}\\
\theta_u(r) \eqdef \beta_u^\top r \in \Real
}{T2.3,T1.1,T0.1}

\ProofBlock{T2.5:U^\top A(r)U}{
U^\top A(r) U = \left(\bigoplus_{u=1}^m \theta_u(r) J\right)\oplus 0_{d_{\mathrm{null}}\times d_{\mathrm{null}}}
}{T1.3,T2.3,T2.4,T0.17,T0.5}

\ProofBlock{T2.6:\exp\mathrm{blk}}{
\exp\!\big(U^\top A(r) U\big)
 = \left(\bigoplus_{u=1}^m R_2(\theta_u(r))\right)\oplus I_{d_{\mathrm{null}}}
}{T2.5,T0.17,T0.11,T0.5}

\ProofBlock{T2.7:R_{\mathrm{STR}}\text{ form}}{
R_{\mathrm{STR}}(r)
 = U\left[\left(\bigoplus_{u=1}^m R_2(\theta_u(r))\right)\oplus I_{d_{\mathrm{null}}}\right]U^\top
}{T1.6,T2.6,T0.11,T2.3}

\ProofBlock{T2.8:R_{\mathrm{STR}}\in SO}{
R_{\mathrm{STR}}(r)\in SO(d_h)\\
\Note{uses $R_2(\theta)\in SO(2)$, block determinant multiplicativity, and $U\in O(d_h)$}
}{T2.7,T0.18,T0.5,T2.3,T0.6,T0.7,T0.4}

\ProofBlock{T2.9:\mathrm{rel}\ R_{\mathrm{STR}}}{
R_{\mathrm{STR}}(r_i)^\top R_{\mathrm{STR}}(r_j) = R_{\mathrm{STR}}(r_j-r_i)
}{T1.4,T1.5,T1.6,T0.11}

\ProofBlock{T2.10:\Pi_{\mathrm{act}},\Pi_{\mathrm{null}},d_{\mathrm{act}}}{
\Pi_{\mathrm{act}} \eqdef U\,\mathrm{diag}(I_{2m},0)\,U^\top\\
\Pi_{\mathrm{null}} \eqdef U\,\mathrm{diag}(0,I_{d_{\mathrm{null}}})\,U^\top\\
\Pi_{\mathrm{act}}^\top = \Pi_{\mathrm{act}},\ \Pi_{\mathrm{act}}^2 = \Pi_{\mathrm{act}}\\
\Pi_{\mathrm{null}}^\top = \Pi_{\mathrm{null}},\ \Pi_{\mathrm{null}}^2 = \Pi_{\mathrm{null}}\\
\Pi_{\mathrm{act}}\Pi_{\mathrm{null}} = 0 \Rightarrow \mathrm{im}(\Pi_{\mathrm{act}})\perp \mathrm{im}(\Pi_{\mathrm{null}})\\
d_{\mathrm{act}} \eqdef \mathrm{rank}(\Pi_{\mathrm{act}}) = 2m
}{T2.3,T0.15,T0.2,T0.14,T0.6}

\ProofBlock{T2.11:\Pi_{\mathrm{act}}\ \mathrm{comm}}{
R_{\mathrm{STR}}(r)\Pi_{\mathrm{act}} = \Pi_{\mathrm{act}} R_{\mathrm{STR}}(r)
}{T2.7,T2.10,T0.5,T0.6}

\section{Tier 3: Cayley Post-Rotations}

\ProofBlock{T3.1:\mathrm{Cayley}}{
S\in\Real^{d_h\times d_h},\ S^\top = -S \Rightarrow (I+S) \text{ invertible}\\
P_{\mathrm{sp}} \eqdef (I-S)(I+S)^{-1}\\
(I-S)(I+S) = (I+S)(I-S) = I-S^2\\
\Note{uses $\sigma(S)\subset i\Real$ so $1+i\mu\neq 0$}
}{T0.16,T0.3,T0.2}

\ProofBlock{T3.2:P_{\mathrm{sp}}\in SO,\mathcal{B}}{
P_{\mathrm{sp}}^\top = ((I+S)^{-1})^\top (I-S)^\top = I\\
\det(P_{\mathrm{sp}}) = \prod_u \frac{1-i\mu_u}{1+i\mu_u} = 1\\
\mathcal{B} \eqdef \{(I-S)(I+S)^{-1} \mid S^\top = -S\} \subseteq SO(d_h)
}{T3.1,T0.16,T0.20,T0.7,T0.6,T0.4,T0.11}

\ProofBlock{T3.3:\mathrm{Cayley}\ \mathrm{surj}}{
Q\in SO(d_h),\ -1\notin \sigma(Q) \Rightarrow S_Q \eqdef (I-Q)(I+Q)^{-1}\\
S_Q^\top = -S_Q,\quad (I-S_Q)(I+S_Q)^{-1} = Q\\
\Note{Cayley transform bijection on $SO(d_h)$ with no $-1$ eigenvalues}
}{T0.16,T0.20,T0.6,T0.4,T0.11,T0.7}

\ProofBlock{T3.4:\mathcal{A}}{
\mathcal{A} \eqdef \Big\{U\,\mathrm{diag}(I_{2m}, R_{\mathrm{null}})\,U^\top \,\Big|\,
R_{\mathrm{null}}\in SO(d_{\mathrm{null}})\Big\} \subseteq SO(d_h)\\
R_{\mathrm{null}}\in SO(d_{\mathrm{null}}),\ -1\notin \sigma(R_{\mathrm{null}})
\Rightarrow U\,\mathrm{diag}(I_{2m}, R_{\mathrm{null}})\,U^\top \in \mathcal{B}
}{T2.3,T0.6,T0.7,T0.5,T0.4,T0.18,T3.3}

\ProofBlock{T3.5:R_{\mathrm{sp}}}{
R_{\mathrm{sp}}(r) \eqdef R_{\mathrm{STR}}(r)P_{\mathrm{sp}}\\
R_{\mathrm{STR}}(r)\in SO(d_h),\ P_{\mathrm{sp}}\in SO(d_h)
\Rightarrow R_{\mathrm{sp}}(r)\in SO(d_h)
}{T2.8,T3.2,T0.6,T0.4}

\ProofBlock{T3.6:\Pi_{\mathrm{act}} R_{\mathrm{sp}} \Pi_{\mathrm{act}}}{
P_{\mathrm{sp}}\in \mathcal{A} \Rightarrow
\Pi_{\mathrm{act}}P_{\mathrm{sp}} = \Pi_{\mathrm{act}} = P_{\mathrm{sp}}\Pi_{\mathrm{act}}\\
R_{\mathrm{STR}}(r)\Pi_{\mathrm{act}} = \Pi_{\mathrm{act}} R_{\mathrm{STR}}(r)\\
\Rightarrow \Pi_{\mathrm{act}}R_{\mathrm{sp}}(r)\Pi_{\mathrm{act}}
= \Pi_{\mathrm{act}}R_{\mathrm{STR}}(r)\Pi_{\mathrm{act}}
}{T3.5,T2.10,T2.11,T3.4,T0.5,T0.6}

\ProofBlock{T3.7:\Pi\text{-}\mathrm{rel}\ R_{\mathrm{sp}}}{
P_{\mathrm{sp}}\in \mathcal{A} \Rightarrow
\Pi_{\mathrm{act}}R_{\mathrm{sp}}(r_i)^\top R_{\mathrm{sp}}(r_j)\Pi_{\mathrm{act}}
= \Pi_{\mathrm{act}}R_{\mathrm{STR}}(r_j-r_i)\Pi_{\mathrm{act}}
}{T3.6,T2.9,T3.5,T3.2,T2.10,T0.6,T0.4}

\section{Tier 4: Attention Queries, Keys, and Scores}

\ProofBlock{T4.1:W,q,k,v}{
W_Q,W_K,W_V \in \Real^{d_h\times D}\\
x_i\in\Real^D,\ r_i\in\Real^{d_c}\\
q_i = W_Q x_i,\quad k_j = W_K x_j,\quad v_j = W_V x_j
}{T0.1,T0.3}

\ProofBlock{T4.2:q^{(\mathrm{act})},k^{(\mathrm{act})},d_{\mathrm{act}}}{
q_i^{(\mathrm{act})} \eqdef \Pi_{\mathrm{act}} q_i,\quad
k_j^{(\mathrm{act})} \eqdef \Pi_{\mathrm{act}} k_j\\
d_{\mathrm{act}} \eqdef 2m
}{T2.10,T4.1}

\ProofBlock{T4.3:\tilde q,\tilde k}{
\tilde q_i = \Pi_{\mathrm{act}} R_{\mathrm{sp}}(r_i) q_i^{(\mathrm{act})}\\
\tilde k_j = \Pi_{\mathrm{act}} R_{\mathrm{sp}}(r_j) k_j^{(\mathrm{act})}
}{T3.5,T4.2,T2.10}

\ProofBlock{T4.4:\alpha_{ij}\ \mathrm{def}}{
\alpha_{ij} \eqdef \frac{\tilde q_i^\top \tilde k_j}{\sqrt{d_{\mathrm{act}}}}\\
= \frac{1}{\sqrt{d_{\mathrm{act}}}}
(q_i^{(\mathrm{act})})^\top
\big(\Pi_{\mathrm{act}}R_{\mathrm{sp}}(r_i)\Pi_{\mathrm{act}}\big)^\top
\big(\Pi_{\mathrm{act}}R_{\mathrm{sp}}(r_j)\Pi_{\mathrm{act}}\big)
k_j^{(\mathrm{act})}\\
\Note{uses $\Pi_{\mathrm{act}}^\top = \Pi_{\mathrm{act}} = \Pi_{\mathrm{act}}^2$}
}{T4.3,T4.2,T2.10,T0.3}

\ProofBlock{T4.5:\alpha_{ij}\ \mathrm{rel}}{
P_{\mathrm{sp}}\in\mathcal{A} \Rightarrow
\alpha_{ij}
= \frac{1}{\sqrt{2m}}
(q_i^{(\mathrm{act})})^\top
\Big(\Pi_{\mathrm{act}}R_{\mathrm{STR}}(r_j-r_i)\Pi_{\mathrm{act}}\Big)
k_j^{(\mathrm{act})}
}{T4.4,T3.6,T3.7,T4.2,T2.9,T2.10,T0.3}

\section{Tier 5: Stability Estimates}

\ProofBlock{T5.1:\varepsilon\ \mathrm{comm}}{
\varepsilon_{ab} \eqdef |[L_a,L_b]|,\quad \varepsilon \eqdef \max_{a,b}\varepsilon_{ab}\\
\bigl|[A(r),A(s)]\bigr|
\le \sum_{a,b}|r_a||s_b|\varepsilon_{ab}
\le |r|_1|s|_1\,\varepsilon
}{T1.3,T1.1,T0.10,T0.9}

\ProofBlock{T5.2:\mathrm{BCH}\ \mathrm{err}}{
\left|
\log\!\big(\exp(A(r))\exp(A(s))\big) - (A(r)+A(s))
\right|
\le \tfrac12 |[A(r),A(s)]| + C |[A(r),A(s)]|^2
}{T0.13,T5.1,T0.12,T0.11,T0.9}

\ProofBlock{T5.3:R_{\mathrm{STR}}\ \mathrm{rel}\ \mathrm{approx}}{
\bigl|
R_{\mathrm{STR}}(r)^\top R_{\mathrm{STR}}(s) - R_{\mathrm{STR}}(s-r)
\bigr|
\le C\,\varepsilon\,|r|_1 |s|_1 + O(\varepsilon^2)
}{T1.6,T1.4,T1.5,T5.2,T5.1,T0.11,T0.12,T0.9}

\ProofBlock{T5.4:S=S_-+E}{
S = S_- + E,\quad S_-^\top = -S_-,\quad |E|\le \eta,\quad 0\le \eta < 1
}{T0.16,T0.9}

\ProofBlock{T5.5:\sigma_{\min}(I+S_-)}{
S_-^\top = -S_- \Rightarrow \sigma(S_-)\subset i\Real\\
\Rightarrow |1+i\mu|\ge 1 \text{ for } \lambda=i\mu \in \sigma(S_-)\\
\sigma_{\min}(I+S_-)\ge 1
}{T5.4,T0.16,T0.8}

\ProofBlock{T5.6:\sigma_{\min}(I+S)}{
\sigma_{\min}(I+S) \ge \sigma_{\min}(I+S_-) - |E| \ge 1-\eta > 0\\
\Rightarrow I+S \text{ invertible}
}{T5.4,T5.5,T0.19,T0.9}

\ProofBlock{T5.7:\mathrm{Cayley}\ \mathrm{Lip}}{
P_{\mathrm{sp}}(S) \eqdef (I-S)(I+S)^{-1},\quad
P_{\mathrm{sp}}(S_-) \eqdef (I-S_-)(I+S_-)^{-1}\\
|P_{\mathrm{sp}}(S) - P_{\mathrm{sp}}(S_-)| \le C'\eta
}{T5.6,T5.4,T0.20,T0.9,T0.12}

\ProofBlock{T5.8:\eta_{\mathrm{mix}}}{
P_{\mathrm{sp}} = U
\begin{bmatrix}
A & B\\
C & D
\end{bmatrix}
U^\top,\quad \eta_{\mathrm{mix}} \eqdef |B| + |C|\\
P_{\mathrm{sp}}\in SO(d_h)\Rightarrow
\begin{bmatrix}
A & B\\
C & D
\end{bmatrix}^\top
\begin{bmatrix}
A & B\\
C & D
\end{bmatrix} = I\\
\Rightarrow |A-I_{2m}| \le C''\eta_{\mathrm{mix}}\\
\Rightarrow |\Pi_{\mathrm{act}}P_{\mathrm{sp}}\Pi_{\mathrm{act}} - \Pi_{\mathrm{act}}|\le C''\eta_{\mathrm{mix}}
}{T3.2,T2.3,T2.10,T0.9,T0.6,T0.5,T0.7}

\ProofBlock{T5.9:\Pi R_{\mathrm{sp}}\Pi\ \mathrm{approx}}{
\bigl|
\Pi_{\mathrm{act}}R_{\mathrm{sp}}(r)\Pi_{\mathrm{act}}
- \Pi_{\mathrm{act}}R_{\mathrm{STR}}(r)\Pi_{\mathrm{act}}
\bigr|
\le C''\eta_{\mathrm{mix}}
}{T3.5,T2.11,T5.8,T2.10,T0.9,T0.6}

\ProofBlock{T5.10:\alpha_{ij}\ \mathrm{stab}}{
\Delta_{ij} \eqdef C\big(\varepsilon |r_i|_1 |r_j|_1 + \eta_{\mathrm{mix}}\big)
|q_i^{(\mathrm{act})}|\,|k_j^{(\mathrm{act})}|\\
\left|
\alpha_{ij} -
\frac{1}{\sqrt{2m}}
(q_i^{(\mathrm{act})})^\top
\Big(\Pi_{\mathrm{act}}R_{\mathrm{STR}}(r_j-r_i)\Pi_{\mathrm{act}}\Big)
k_j^{(\mathrm{act})}
\right|
\le \Delta_{ij}
}{T4.4,T5.9,T5.3,T4.2,T5.1,T0.12,T0.9,T2.10}

\section{Tier 6: Conclusions}

\ProofBlock{T6.1:\mathrm{GOAL}}{
\big(T1.1 \wedge T2.3 \wedge P_{\mathrm{sp}}\in\mathcal{A}\big)
\Rightarrow
\alpha_{ij}
= \frac{1}{\sqrt{2m}}
(q_i^{(\mathrm{act})})^\top
\Big(\Pi_{\mathrm{act}}R_{\mathrm{STR}}(r_j-r_i)\Pi_{\mathrm{act}}\Big)
k_j^{(\mathrm{act})}
}{T4.5,T3.4,T2.3,T1.1,T2.10}

\ProofBlock{T6.2:\mathrm{GOAL}_{\mathrm{rob}}}{
\Big(
|[L_a,L_b]|\le \varepsilon\ \forall a,b,\quad
P_{\mathrm{sp}}\in SO(d_h)\ \text{with mixing }\eta_{\mathrm{mix}}
\Big)
\Rightarrow
\alpha_{ij} \approx_{\Delta_{ij}}
\frac{1}{\sqrt{2m}}
(q_i^{(\mathrm{act})})^\top
\Big(\Pi_{\mathrm{act}}R_{\mathrm{STR}}(r_j-r_i)\Pi_{\mathrm{act}}\Big)
k_j^{(\mathrm{act})}\\
\Delta_{ij} \le C\big(\varepsilon |r_i|_1 |r_j|_1 + \eta_{\mathrm{mix}}\big)
|q_i^{(\mathrm{act})}|\,|k_j^{(\mathrm{act})}|
}{T5.10,T0.12,T5.1,T5.8,T4.2,T2.10}

\section{Tier 6$^\prime$: Quantified Robustness}

\ProofBlock{T6'.0:\varepsilon_{\mathrm{comm}},\Lambda,R,S,S_-,E,\rho,\eta,\eta_{\mathrm{mix}}}{
\varepsilon_{\mathrm{comm}} \eqdef \max_{a,b\in K} \big|[L_a,L_b]\big|\\
\Lambda \eqdef \max_{u\in\{1,\dots,m\}} \sum_{k=1}^{d_c} |\lambda_{k,u}|\\
R \eqdef \max_i |r_i|_1\\
S \eqdef S_- + E,\quad S_-^\top=-S_-,\quad E^\top=-E\\
\rho \eqdef |S|,\quad \eta \eqdef |E|\\
\eta_{\mathrm{mix}} \eqdef \max\Big\{ \big|\Pi_{\mathrm{null}}P_{\mathrm{sp}}\Pi_{\mathrm{act}}\big|,\ \big|\Pi_{\mathrm{act}}P_{\mathrm{sp}}\Pi_{\mathrm{null}}\big| \Big\}
}{T1.1,T2.3,T2.4,T0.10,T0.9,T0.16,T3.2}

\ProofBlock{T6'.1:|A(r)|,\text{BCH const}}{
|A(r)| \overset{T2.5}{\le} \sum_{u=1}^m |\theta_u(r)|
 \overset{T2.4}{=} \sum_{u=1}^m \Big|\sum_{k=1}^{d_c} r_k \lambda_{k,u}\Big|
\le \Lambda\,|r|_1\\[3pt]
C_{\mathrm{BCH}}(r,s) \eqdef C_\star \exp\!\big(2\Lambda(|r|_1+|s|_1)\big)
}{T2.5,T2.4,T0.9,T0.12}

\ProofBlock{T6'.2:\mathrm{BCH}\ \mathrm{quant}}{
\Big|\log\!\big(e^{A(r)}e^{A(s)}\big) - (A(r)+A(s))\Big|
\overset{T0.13}{\le} \tfrac12|[A(r),A(s)]| + C|[A(r),A(s)]|^2\\
\overset{T5.1}{\le} \tfrac12\,\varepsilon_{\mathrm{comm}}|r|_1|s|_1
 + C_{\mathrm{BCH}}(r,s)\,\varepsilon_{\mathrm{comm}}^2 |r|_1^2 |s|_1^2
}{T0.13,T5.1,T6'.1}

\ProofBlock{T6'.3:\mathrm{Rel}\ \mathrm{approx}\ R_{\mathrm{STR}}}{
R_{\mathrm{STR}}(r)^\top R_{\mathrm{STR}}(s)
\overset{T1.6}{=} e^{-A(r)}e^{A(s)}\\
\log\!\big(R_{\mathrm{STR}}(r)^\top R_{\mathrm{STR}}(s)\big)
\overset{T0.11}{=} \log\!\big(e^{-A(r)}e^{A(s)}\big)
\overset{T6'.2}{=} A(s)-A(r)+\Delta_{rs}\\
A(s)-A(r) \overset{T1.3}{=} A(s-r)\\
\Rightarrow\ \big|R_{\mathrm{STR}}(r)^\top R_{\mathrm{STR}}(s) - R_{\mathrm{STR}}(s-r)\big|
\le C_1\,\varepsilon_{\mathrm{comm}}|r|_1|s|_1 + C_2\,\varepsilon_{\mathrm{comm}}^2 |r|_1^2 |s|_1^2
}{T1.6,T0.11,T6'.2,T1.3,T0.12}

\ProofBlock{T6'.4:\sigma_{\min}(I+S),|(I+S)^{-1}|}{
\sigma_{\min}(I+S) \overset{T0.19}{\ge} \sigma_{\min}(I) - |S| = 1-\rho\\
|(I+S)^{-1}| = \sigma_{\min}(I+S)^{-1} \le (1-\rho)^{-1}
}{T0.19,T0.8,T0.9}

\ProofBlock{T6'.5:\mathrm{Cayley}\ \mathrm{Lip}}{
P_{\mathrm{sp}}(S) \eqdef (I-S)(I+S)^{-1}\\
P_{\mathrm{sp}}(S_1)-P_{\mathrm{sp}}(S_2)
=(S_2-S_1)(I+S_1)^{-1} + (I-S_2)\big[(I+S_2)^{-1}-(I+S_1)^{-1}\big]\\
(I+S_2)^{-1}-(I+S_1)^{-1} = (I+S_2)^{-1}(S_1-S_2)(I+S_1)^{-1}\\
\Rightarrow |P_{\mathrm{sp}}(S_1)-P_{\mathrm{sp}}(S_2)|
\le \frac{2}{\sigma_{\min}(I+S_1)\,\sigma_{\min}(I+S_2)}\,|S_1-S_2|\\
\Rightarrow |P_{\mathrm{sp}}(S)-P_{\mathrm{sp}}(S_-)| \le \frac{2}{(1-\rho)^2}\,\eta
}{T3.1,T0.9,T6'.4}

\ProofBlock{T6'.6:\mathrm{Neumann}}{
|S|=\rho<1 \Rightarrow (I+S)^{-1} = \sum_{t=0}^\infty (-S)^t\\
P_{\mathrm{sp}}(S) = (I-S)\sum_{t=0}^\infty (-S)^t = I - 2\sum_{u=1}^\infty (-1)^{u-1} S^u
}{T0.9,T0.12}

\ProofBlock{T6'.7:\mathrm{QuadMix}\ \Pi_{\mathrm{act}}}{
\Pi_{\mathrm{act}}S\Pi_{\mathrm{act}} = 0,\quad \Pi_{\mathrm{null}}S\Pi_{\mathrm{null}} = S_{\mathrm{null}}\\
\Pi_{\mathrm{act}}S^2\Pi_{\mathrm{act}} = (\Pi_{\mathrm{act}}S\Pi_{\mathrm{null}})(\Pi_{\mathrm{null}}S\Pi_{\mathrm{act}})
\Rightarrow |\Pi_{\mathrm{act}}S^2\Pi_{\mathrm{act}}| \le \eta^2\\
\Pi_{\mathrm{act}}P_{\mathrm{sp}}(S)\Pi_{\mathrm{act}} - \Pi_{\mathrm{act}}
= -2\sum_{u=1}^\infty (-1)^{u-1}\Pi_{\mathrm{act}}S^u\Pi_{\mathrm{act}}
= -2\sum_{u=2}^\infty (-1)^{u-1}\Pi_{\mathrm{act}}S^u\Pi_{\mathrm{act}}\\
\Rightarrow \big|\Pi_{\mathrm{act}}P_{\mathrm{sp}}(S)\Pi_{\mathrm{act}} - \Pi_{\mathrm{act}}\big|
\le 2\sum_{u=2}^\infty \big|\Pi_{\mathrm{act}}S^u\Pi_{\mathrm{act}}\big|
\le 2\sum_{u=2}^\infty \rho^{u-2}\,|\Pi_{\mathrm{act}}S^2\Pi_{\mathrm{act}}|\\
\le \frac{2}{1-\rho}\,\eta^2 \le \frac{2}{(1-\rho)^3}\,\eta^2
}{T6'.6,T0.9}

\ProofBlock{T6'.8:\mathrm{Mix}\ \text{model-free}}{
P_{\mathrm{sp}} = U
\begin{bmatrix}A & B\\ C & D\end{bmatrix}
U^\top,\quad
A^\top A + C^\top C = I,\quad AA^\top + BB^\top = I\\
|A-I| \le 2\max\{|B|,|C|\} = 2\,\eta_{\mathrm{mix}}\\
\Rightarrow \big|\Pi_{\mathrm{act}}P_{\mathrm{sp}}\Pi_{\mathrm{act}} - \Pi_{\mathrm{act}}\big| \le 2\,\eta_{\mathrm{mix}}
}{T3.2,T2.3,T2.10,T0.6,T0.9}

\ProofBlock{T6'.9:\mathrm{Rob}\ R_{\mathrm{sp}}\ \text{on act}}{
\big|\Pi_{\mathrm{act}}R_{\mathrm{sp}}(r)\Pi_{\mathrm{act}} - \Pi_{\mathrm{act}}R_{\mathrm{STR}}(r)\Pi_{\mathrm{act}}\big|
= \big|\Pi_{\mathrm{act}}R_{\mathrm{STR}}(r)\big(P_{\mathrm{sp}}-\Pi_{\mathrm{act}}-\Pi_{\mathrm{null}}\big)\Pi_{\mathrm{act}}\big|\\
\overset{T0.9}{\le} \big|P_{\mathrm{sp}}-\Pi_{\mathrm{act}}-\Pi_{\mathrm{null}}\big|
\le
\begin{cases}
\dfrac{2}{(1-\rho)^3}\,\eta^2, & \text{(ESPR/Cayley/pure mix)},\\[4pt]
2\,\eta_{\mathrm{mix}}, & \text{(model-free)}.
\end{cases}
 \eqcolon \delta_{\mathrm{mix}}
}{T3.5,T2.11,T6'.7,T6'.8,T0.9}

\ProofBlock{T6'.10:\mathrm{Logit}\ \mathrm{err}}{
\alpha_{ij} \overset{T4.4}{=} \tfrac{1}{\sqrt{2m}}(q_i^{(\mathrm{act})})^\top
\Big(\Pi_{\mathrm{act}}R_{\mathrm{sp}}(r_i)^\top R_{\mathrm{sp}}(r_j)\Pi_{\mathrm{act}}\Big)k_j^{(\mathrm{act})}\\
\alpha_{ij}^{\star} \eqdef \tfrac{1}{\sqrt{2m}}(q_i^{(\mathrm{act})})^\top
\Big(\Pi_{\mathrm{act}}R_{\mathrm{STR}}(r_j-r_i)\Pi_{\mathrm{act}}\Big)k_j^{(\mathrm{act})}\\
|\alpha_{ij}-\alpha_{ij}^{\star}|
\le \tfrac{1}{\sqrt{2m}}|q_i^{(\mathrm{act})}|\,|k_j^{(\mathrm{act})}|\\
\cdot\Big(\big|\Pi_{\mathrm{act}}\big(R_{\mathrm{sp}}(r_i)^\top R_{\mathrm{sp}}(r_j)-R_{\mathrm{STR}}(r_j-r_i)\big)\Pi_{\mathrm{act}}\big|
+\big|\Pi_{\mathrm{act}}R_{\mathrm{sp}}(\cdot)\Pi_{\mathrm{act}}-\Pi_{\mathrm{act}}R_{\mathrm{STR}}(\cdot)\Pi_{\mathrm{act}}\big|\Big)\\
\le |q_i^{(\mathrm{act})}|\,|k_j^{(\mathrm{act})}|
\Big(C_1\,\varepsilon_{\mathrm{comm}}|r_i|_1|r_j|_1 + C_2\,\varepsilon_{\mathrm{comm}}^2|r_i|_1^2|r_j|_1^2
+\delta_{\mathrm{mix}}\Big)
}{T4.4,T2.10,T6'.3,T6'.9,T0.9}

\ProofBlock{T6'.11:\mathrm{Rob}\ \mathrm{theorem}}{
\big|\alpha_{ij}-\alpha_{ij}^{\star}\big|
\le \Big(\tfrac12 + C_{\mathrm{BCH}}(r_i,r_j)\Big)\varepsilon_{\mathrm{comm}}|r_i|_1|r_j|_1\,|q_i^{(\mathrm{act})}|\,|k_j^{(\mathrm{act})}|\\
+ C_{\mathrm{mix}}\delta_{\mathrm{mix}} |q_i^{(\mathrm{act})}|\,|k_j^{(\mathrm{act})}|\\[3pt]
\begin{cases}
C_{\mathrm{mix}}=1,\ \delta_{\mathrm{mix}}=\eta_{\mathrm{mix}}, & \text{(model-free)},\\[4pt]
C_{\mathrm{mix}}=\dfrac{2}{(1-\rho)^3},\ \delta_{\mathrm{mix}}=\eta^2, & \text{(ESPR/Cayley/pure mix)}.
\end{cases}
}{T6'.1,T6'.3,T6'.9,T6'.10,T0.12,T0.9}

\ProofBlock{T6'.12:\text{Replacements}}{
\{T5.2,\ T5.3\} \leadsto \{T6'.2,\ T6'.3\}\\
\{T5.7\} \leadsto \{T6'.5\}\\
\{T5.8,\ T5.9\} \leadsto \{T6'.7,\ T6'.9\}\\
\{T6.2\} \leadsto \{T6'.11\}
}{T5.2,T5.3,T5.7,T5.8,T5.9,T6.2,T6'.2,T6'.3,T6'.5,T6'.7,T6'.9,T6'.11}
\section{Tier 7: Positive Random Features and Variance Bounds}

\ProofBlock{T7.0:\mathcal{N}(0,I_n),\mathbb{E},\mathrm{Var}}{
\mathcal{N}(0,I_n) \eqdef \text{the mean-zero Gaussian law on }\Real^n\text{ with density } (2\pi)^{-n/2}\exp\!\big(-\tfrac12|w|^2\big)\\[4pt]
w\sim\mathcal{N}(0,I_n) \Rightarrow \mathbb{E}[w] = 0,\quad \mathbb{E}[w w^\top] = I_n\\[4pt]
\mathbb{E}[\cdot] \eqdef \text{expectation with respect to the (joint) law of all Gaussian draws }w\\
\mathrm{Var}[Z] \eqdef \mathbb{E}[Z^2] - (\mathbb{E}[Z])^2 \quad\text{for any scalar random variable }Z
}{T0.9,T0.3,T0.1}

\ProofBlock{T7.1:\mathrm{RF\ setup}}{
d_{\mathrm{act}} = 2m \text{ from T2.10}\\[4pt]
\text{For probabilistic estimates we draw } w \sim \mathcal{N}(0,I_{d_{\mathrm{act}}}) \text{ in the sense of T7.0}\\[4pt]
\phi_w(x) \eqdef \exp\!\Big(w^\top x - \tfrac12 |x|^2\Big) \quad (x\in\Real^{d_{\mathrm{act}}})\\
\Note{positive softmax random feature map as in FAVOR\,+ estimators}\\[4pt]
Z(x,y;w) \eqdef \phi_w(x)\,\phi_w(y) = \exp\!\Big(w^\top(x+y) - \tfrac12(|x|^2+|y|^2)\Big) \quad (x,y\in\Real^{d_{\mathrm{act}}})\\[4pt]
\widehat{\mathrm{SM}}_{n_{\mathrm{rf}}}(x,y) \eqdef \frac{1}{n_{\mathrm{rf}}} \sum_{t=1}^{n_{\mathrm{rf}}} Z(x,y;w_t) \quad \text{for }n_{\mathrm{rf}}\in\mathbb{N},\ w_t \text{ i.i.d. } \mathcal{N}(0,I_{d_{\mathrm{act}}})\\[4pt]
\text{Note: }\widehat{\mathrm{SM}}_{n_{\mathrm{rf}}}(x,y) \text{ is our Monte Carlo estimator of }\exp(x^\top y) \text{ (unnormalized softmax kernel)}
}{T2.10,T7.0,T0.3,T0.9,T0.1}

\ProofBlock{T7.2:\widehat q_i,\widehat k_j,\alpha_{ij}}{
\tilde q_i,\tilde k_j \text{ from T4.3},\quad q_i^{(\mathrm{act})},k_j^{(\mathrm{act})} \text{ from T4.2}\\[4pt]
\alpha_{ij} \eqdef \frac{1}{\sqrt{d_{\mathrm{act}}}}\tilde q_i^\top \tilde k_j \quad\text{from T4.4 and T2.10}\\[4pt]
\widehat q_i \eqdef d_{\mathrm{act}}^{-1/4}\,\tilde q_i, \quad \widehat k_j \eqdef d_{\mathrm{act}}^{-1/4}\,\tilde k_j\\[4pt]
\widehat q_i^\top \widehat k_j = (d_{\mathrm{act}}^{-1/4}\tilde q_i)^\top (d_{\mathrm{act}}^{-1/4}\tilde k_j) = d_{\mathrm{act}}^{-1/2} \tilde q_i^\top \tilde k_j = \alpha_{ij}\\[4pt]
\Rightarrow \alpha_{ij} = \widehat q_i^\top \widehat k_j\\[4pt]
\Note{ The attention logit \(\alpha_{ij}\) is \emph{exactly} a Euclidean dot product between \(\widehat q_i,\widehat k_j \in \Real^{d_{\mathrm{act}}}\), with no remaining \(\tfrac{1}{\sqrt{d_{\mathrm{act}}}}\) factor. }
}{T4.3,T4.4,T4.2,T2.10,T0.9,T0.1}

\ProofBlock{T7.3:\mathbb{E}Z=\exp(x^\top y),\text{unbiasedness}}{
\text{Fix } x,y\in\Real^{d_{\mathrm{act}}}. \ Z(x,y;w) = \exp\!\Big( w^\top(x+y) - \tfrac12(|x|^2+|y|^2) \Big)\\[4pt]
\text{For } w\sim\mathcal{N}(0,I_{d_{\mathrm{act}}}) \text{ (T7.0), } w^\top(x+y) \text{ is scalar Gaussian with mean }0\text{ and variance }|x+y|^2.\\[4pt]
\mathbb{E}_w\big[\exp(u^\top w)\big] = \exp\!\Big(\tfrac12|u|^2\Big) \quad \text{for any fixed }u\in\Real^{d_{\mathrm{act}}} \text{ (Gaussian MGF).}\\[4pt]
\Rightarrow \mathbb{E}[Z(x,y;w)] = \exp\!\Big( \tfrac12|x+y|^2 - \tfrac12(|x|^2+|y|^2) \Big)\\[4pt]
|x+y|^2 = |x|^2+|y|^2+2 x^\top y \quad\text{(T0.9 inner-product expansion)}\\[4pt]
\Rightarrow \mathbb{E}[Z(x,y;w)] = \exp\!\Big( \tfrac12(|x|^2+|y|^2+2 x^\top y) - \tfrac12(|x|^2+|y|^2) \Big) = \exp(x^\top y)\\[6pt]
\text{Now choose } x=\widehat q_i,\ y=\widehat k_j \text{ from T7.2. Then } x^\top y = \alpha_{ij}.\\[4pt]
\Rightarrow \mathbb{E}[Z(\widehat q_i,\widehat k_j;w)] = \exp(\alpha_{ij})\\[6pt]
\Rightarrow \mathbb{E}\Big[ \widehat{\mathrm{SM}}_{n_{\mathrm{rf}}}(\widehat q_i,\widehat k_j) \Big] = \frac{1}{n_{\mathrm{rf}}} \sum_{t=1}^{n_{\mathrm{rf}}} \mathbb{E}[Z(\widehat q_i,\widehat k_j;w_t)] = \exp(\alpha_{ij})\\[6pt]
\text{Note: }\widehat{\mathrm{SM}}_{n_{\mathrm{rf}}}(\widehat q_i,\widehat k_j) \text{ is an \emph{unbiased} positive estimator of }\exp(\alpha_{ij}), \text{ the \emph{unnormalized} softmax score. No claim is made here about the unbiasedness of the \emph{normalized} attention weight }\exp(\alpha_{ij})/\sum_{j'}\exp(\alpha_{ij'})\text{, because that introduces a random denominator.}
}{T7.1,T7.2,T7.0,T0.9,T0.11}

\ProofBlock{T7.4:\mathbb{E}Z^2,\mathrm{Var}Z,\text{closed form}}{
\text{Continue with fixed } x,y\in\Real^{d_{\mathrm{act}}}.\\[4pt]
Z(x,y;w) = \exp\!\Big( w^\top(x+y) - \tfrac12(|x|^2+|y|^2) \Big)\\
Z(x,y;w)^2 = \exp\!\Big( 2w^\top(x+y) - (|x|^2+|y|^2) \Big)\\[4pt]
\mathbb{E}[Z(x,y;w)^2] = \exp\!\Big( \tfrac12|2(x+y)|^2 - (|x|^2+|y|^2) \Big) = \exp\!\Big( 2|x+y|^2 - (|x|^2+|y|^2) \Big)\\[4pt]
|x+y|^2 = |x|^2+|y|^2+2 x^\top y \text{ (as used in T7.3)}\\[4pt]
\Rightarrow 2|x+y|^2 - (|x|^2+|y|^2) = 2(|x|^2+|y|^2+2 x^\top y) - (|x|^2+|y|^2) = |x|^2 + |y|^2 + 4 x^\top y\\[4pt]
\Rightarrow \mathbb{E}[Z(x,y;w)^2] = \exp\!\Big( |x|^2 + |y|^2 + 4 x^\top y \Big)\\[6pt]
\mathbb{E}[Z(x,y;w)] = \exp(x^\top y) \quad\text{from T7.3}\\
(\mathbb{E}[Z(x,y;w)])^2 = \exp(2 x^\top y)\\[4pt]
\mathrm{Var}[Z(x,y;w)] = \mathbb{E}[Z(x,y;w)^2] - (\mathbb{E}[Z(x,y;w)])^2\\[2pt]
= \exp\!\Big( |x|^2 + |y|^2 + 4 x^\top y \Big) - \exp\!\Big( 2 x^\top y \Big)\\[6pt]
\mathrm{Var}[Z(x,y;w)] = \exp\!\Big( 2 x^\top y \Big) \Big[ \exp\!\Big( |x|^2 + |y|^2 + 2 x^\top y \Big) - 1 \Big]\\[4pt]
\text{Note: The single-sample variance is finite and given in closed form for all finite }x,y\text{.}
}{T7.3,T7.1,T7.0,T0.9}

\ProofBlock{T7.5:\mathrm{Var}\ \widehat{\mathrm{SM}}_{n_{\mathrm{rf}}},\text{geom link}}{
\text{The draws } w_t \text{ in T7.1 are i.i.d., so the } Z(\cdot;w_t) \text{ are i.i.d.}\\[4pt]
\widehat{\mathrm{SM}}_{n_{\mathrm{rf}}}(x,y) = \frac{1}{n_{\mathrm{rf}}} \sum_{t=1}^{n_{\mathrm{rf}}} Z(x,y;w_t)\\[4pt]
\mathrm{Var}\Big[ \widehat{\mathrm{SM}}_{n_{\mathrm{rf}}}(x,y) \Big] = \frac{1}{n_{\mathrm{rf}}^2} \sum_{t=1}^{n_{\mathrm{rf}}} \mathrm{Var}[Z(x,y;w_t)] = \frac{1}{n_{\mathrm{rf}}} \mathrm{Var}[Z(x,y;w)] \quad\text{(i.i.d.\ variance scaling)}\\[6pt]
\text{Insert the expression from T7.4:}\\[4pt]
\mathrm{Var}\Big[ \widehat{\mathrm{SM}}_{n_{\mathrm{rf}}}(x,y) \Big] = \frac{1}{n_{\mathrm{rf}}} \exp\!\Big( 2 x^\top y \Big) \Big[ \exp\!\Big( |x|^2+|y|^2+2 x^\top y \Big) - 1 \Big]\\[6pt]
\text{Now specialise } x=\widehat q_i,\ y=\widehat k_j \text{ from T7.2. Then } x^\top y = \alpha_{ij}.\\[4pt]
\Rightarrow \mathrm{Var}\Big[ \widehat{\mathrm{SM}}_{n_{\mathrm{rf}}}(\widehat q_i,\widehat k_j) \Big] = \frac{1}{n_{\mathrm{rf}}} \exp\!\Big( 2 \alpha_{ij} \Big) \Big[ \exp\!\Big( |\widehat q_i|^2+|\widehat k_j|^2+2 \alpha_{ij} \Big) - 1 \Big]\\[6pt]
\text{Relate } |\widehat q_i|,|\widehat k_j| \text{ back to geometric quantities already controlled in T5.10.}\\[4pt]
\widehat q_i = d_{\mathrm{act}}^{-1/4}\tilde q_i,\quad \widehat k_j = d_{\mathrm{act}}^{-1/4}\tilde k_j \text{ from T7.2} \Rightarrow |\widehat q_i|^2 + |\widehat k_j|^2 = d_{\mathrm{act}}^{-1/2} (|\tilde q_i|^2+|\tilde k_j|^2)\\[4pt]
\tilde q_i = \Pi_{\mathrm{act}} R_{\mathrm{sp}}(r_i) q_i^{(\mathrm{act})} \text{ and } \tilde k_j = \Pi_{\mathrm{act}} R_{\mathrm{sp}}(r_j) k_j^{(\mathrm{act})} \text{ from T4.3.}\\[4pt]
R_{\mathrm{sp}}(r) \in SO(d_h) \text{ (T3.5) so } |R_{\mathrm{sp}}(r)z| = |z| \text{ for all }z\in\Real^{d_h},\\
\Pi_{\mathrm{act}} \text{ is an orthogonal projector (T2.10) so } |\Pi_{\mathrm{act}} z|\le |z| \text{ for all }z.\\[4pt]
\Rightarrow |\tilde q_i| \le |q_i^{(\mathrm{act})}|, \quad |\tilde k_j| \le |k_j^{(\mathrm{act})}|\\[4pt]
\Rightarrow |\tilde q_i|^2 + |\tilde k_j|^2 \le |q_i^{(\mathrm{act})}|^2 + |k_j^{(\mathrm{act})}|^2\\[6pt]
\Note{ 1) The estimator \(\widehat{\mathrm{SM}}_{n_{\mathrm{rf}}}(\widehat q_i,\widehat k_j)\) is unbiased for \(\exp(\alpha_{ij})\) (T7.3).\\[4pt] 2) Its variance decays exactly as \(1/n_{\mathrm{rf}}\).\\[4pt] 3) The variance prefactor depends on \(\alpha_{ij}\), \(|\widehat q_i|^2+|\widehat k_j|^2 = d_{\mathrm{act}}^{-1/2}(|\tilde q_i|^2+|\tilde k_j|^2)\), and thus is controlled by \(|q_i^{(\mathrm{act})}|\) and \(|k_j^{(\mathrm{act})}|\), which already enter the geometric stability bound T5.10.\\[4pt] 4) Under standard attention scaling, \(\alpha_{ij} = O(1)\) as \(d_{\mathrm{act}}\) grows, and \(|q_i^{(\mathrm{act})}|\), \(|k_j^{(\mathrm{act})}|\) scale so that \(|\widehat q_i|^2\) and \(|\widehat k_j|^2\) remain \(O(1)\). Hence the exponential factor in the variance is not pathological. }
}{T7.4,T7.2,T7.1,T4.3,T4.2,T3.5,T2.10,T0.9,T0.3,T0.6}

\section{Tier $8^\prime$: Tight Assumptions and OOD Dominance}

\ProofBlock{T8'.0: $\|\cdot\|_2,\ \|\cdot\|_F,\ \mathbb{S}^{d_h-1}$}{
\|M\|_2 \eqdef \|M\| \ (\text{operator norm; T0.9}),\quad
\|M\|_F \eqdef \sqrt{\operatorname{tr}(M^\top M)}\\
\mathbb{S}^{d_h-1} \eqdef \{z\in\mathbb{R}^{d_h}:\ \|z\|_2=1\}
}{T0.9,T0.3}

\ProofBlock{T8'.1: $(\mathcal{X},\mathcal{Y}),\ \mathcal{D},\ \mathcal{T},\ \Phi_\#\mathcal{D}$}{
\mathcal{X},\mathcal{Y}\ \text{measurable},\ (X,Y)\sim\mathcal{D}\\
\mathcal{T}\subseteq\{\Phi:\mathcal{X}\to\mathcal{X}\ \text{bijective, measurable}\}\\
\Phi_\#\mathcal{D}\ \eqdef\ \text{pushforward: }(X',Y')\sim\Phi_\#\mathcal{D}\iff (X',Y')=(\Phi\!\cdot\!X,Y),\ (X,Y)\sim\mathcal{D}\\
(\Phi\!\cdot\!x)(u)\ \eqdef\ x(\Phi^{-1}u)
}{T0.1}

\ProofBlock{T8'.1bis: $\Pi_\Delta,\ \nu,\ A_\Phi$}{
\exists\ \Pi_\Delta:\mathcal{T}\to \mathrm{supp}(\nu)\ \text{measurable},\ \exists A_\Phi\in SO(d_h):\
\Pi_{\mathrm{act}} R_{\mathrm{STR}}(\Pi_\Delta(\Phi)) \Pi_{\mathrm{act}} \ =\ \Pi_{\mathrm{act}} A_\Phi \Pi_{\mathrm{act}},\qquad
\Pi_{\Delta\#}\mu=\nu
}{T2.7,T2.10,T3.2,T8'.1}

\ProofBlock{T8'.2: Label invariance}{
\forall \Phi\in\mathcal{T}:\ \Pr\big[(X,Y)\sim\mathcal{D},\ (X',Y')\sim\Phi_\#\mathcal{D}:\ Y'=Y\big]=1
}{T8'.1}

\ProofBlock{T8'.3: $\psi,\ \ell,\ $bounded logits, $L$}{
\psi:\mathbb{R}^{d_h}\to\mathbb{R}^{C},\ \ \ell:\mathbb{R}^C\times\mathcal{Y}\to\mathbb{R}_+\\
\exists B_\psi>0:\ \sup_{x\in\mathcal{X}}\|\psi(z_f(x))\|_2\le B_\psi\ \ (\text{e.g.\ spectral norm or fixed LayerNorm})\\
\exists L>0:\ \forall y,\ \ell(\cdot,y)\ \text{is }L\text{-Lipschitz on }\{u\in\mathbb{R}^C:\ \|u\|_2\le B_\psi\}
}{T0.9}

\ProofBlock{T8'.4: $z_f$ measurable, $B_z$}{
z_f:\mathcal{X}\to\mathbb{R}^{d_h}\ \text{measurable},\quad \sup_{x\in\mathcal{X}}\|z_f(x)\|_2\le B_z
}{T0.9}

\ProofBlock{T8'.5: $\nu,\ \Delta,\ R_\Delta$}{
\nu:\ \text{prob.\ on }\mathbb{R}^{d_c},\ \Delta\sim\nu,\ \ \|\Delta\|_1\le R_\Delta\ \text{a.s.}
}{T0.1,T0.9}

\ProofBlock{T8'.5bis: $r$-radius}{
r\in\mathbb{R}^{d_c},\ \|r\|_1\le R,\ R>0
}{T0.9}

\ProofBlock{T8'.6: $\mathcal{H}_{\mathrm{STRING}},\ \mathcal{H}_{\mathrm{ESPR}}$}{
\mathcal{H}_{\mathrm{STRING}} \eqdef \{f:\ P_{\mathrm{sp}}\in\mathcal{A},\ [L_a,L_b]=0\}\\
\mathcal{H}_{\mathrm{ESPR}} \eqdef \{f:\ P_{\mathrm{sp}}\in SO(d_h),\ \|[L_a,L_b]\|\le \varepsilon_{\mathrm{comm}},\ \eta_{\mathrm{mix}}\ \text{as in T6'.0}\}\\
\mathcal{H}_{\mathrm{STRING}}\subset \mathcal{H}_{\mathrm{ESPR}}
}{T3.4,T3.2,T6'.0}

\ProofBlock{T8'.7: $\mathrm{IR}_{\mathrm{spec}}(f)$}{
\Pi_{\mathrm{act}}:\ \text{orth.\ projector onto first }2m\text{ coords},\ \Pi_{\mathrm{null}}=I-\Pi_{\mathrm{act}}\ (\text{T2.10})\\
R_{\mathrm{STR}}(\cdot):\ \text{block }(2\times 2)\text{ rotations on }m\text{ planes (identity on null; T2.7)}\\
R_{\mathrm{sp}}(r)\ \eqdef\ P_{\mathrm{sp}} R_{\mathrm{STR}}(r) P_{\mathrm{sp}}^\top,\ P_{\mathrm{sp}}\in SO(d_h)\[2pt]
\mathrm{IR}_{\mathrm{spec}}(f)\ \eqdef\ \mathbb{E}_{\Delta\sim\nu}\ \sup_{\|r\|_1\le R}\ \big\|\ \Pi_{\mathrm{act}}R_{\mathrm{sp}}(r)^\top R_{\mathrm{sp}}(r+\Delta)\Pi_{\mathrm{act}}
-\Pi_{\mathrm{act}}R_{\mathrm{STR}}(\Delta)\Pi_{\mathrm{act}}\ \big\|_2
}{T2.10,T2.7,T3.2,T6'.3,T6'.9,T0.9,T8'.5,T8'.5bis}

\ProofBlock{T8'.8: $C_{\mathrm{comm}},C_{\mathrm{mix}},C_{\mathcal{T}},\ \rho$}{
C_{\mathrm{comm}} \eqdef \tfrac12\,\varepsilon_{\mathrm{comm}}(R+R_\Delta)^2 \;+\; C_{\mathrm{BCH}}(2R+R_\Delta)\,\varepsilon_{\mathrm{comm}}^2 (R+R_\Delta)^4\\
\rho \eqdef \|S\|_2<1\ \text{ for }P_{\mathrm{sp}}=\mathrm{cayley}(S)\ \ (\text{Neumann; T6'.6})\\
C_{\mathrm{mix}} \eqdef
\begin{cases}
\dfrac{2}{(1-\rho)^3}\,\eta^2, & \text{(ESPR/Cayley/pure mix)}\\
\eta_{\mathrm{mix}}, & \text{(model-free)}
\end{cases},\quad
C_{\mathcal{T}} \eqdef 1\ \ \text{($C_{\mathrm{BCH}}(\cdot)$ absorbs higher-order BCH under T8'.8bis)}
}{T6'.1,T6'.5,T6'.6,T6'.7,T6'.8,T6'.0}

\ProofBlock{T8'.8bis: small-angle/BCH}{
\varepsilon_{\mathrm{comm}},\ \eta_{\mathrm{mix}},\ R,\ R_\Delta\ \text{small so higher-order BCH terms are absorbed into }C_{\mathrm{BCH}}
}{T6'.1,T6'.2}

\ProofBlock{T8'.8A1: FreqNorm}{
\lambda_{k,u}\ \text{from T2.4},\quad \theta_u(r)=\sum_{k=1}^{d_c}\lambda_{k,u}r_k\\
\exists \Lambda_0>0:\ \sum_{k=1}^{d_c}|\lambda_{k,u}|\ \le\ \frac{\Lambda_0}{m}\ \ \forall u
\ \Rightarrow\ \Lambda=\frac{\Lambda_0}{m},\ \ |\theta_u(r)|\le \frac{\Lambda_0}{m}\,\|r\|_1
}{T2.4,T6'.1,T0.12}

\ProofBlock{T8'.8A2: MixBudget}{
E:\ \text{off-block mixing on }(2m)\times(d_h-2m)\\
\|E\|_F^2\ \le\ B_{\mathrm{mix}}^2\ \Rightarrow\ \eta=\|E\|_2\ \le\ \|E\|_F \le B_{\mathrm{mix}}\\
\ \Rightarrow\ \eta\ \le\ \frac{B_{\mathrm{mix}}}{\sqrt{m}}\ \ \text{(if budget spreads across $m$ planes)}
}{T6'.0,T0.9}

\ProofBlock{T8'.8c: Capacity scaling}{
C_{\mathrm{comm}}=\exp\!\big(O(R/m)\big)\cdot O\!\big(\varepsilon_{\mathrm{comm}}(R+R_\Delta)^2\big),\qquad
C_{\mathrm{mix}}=O\!\Big(\frac{B_{\mathrm{mix}}^2}{(1-\rho)^3\,m}\Big)\ \ \ (\text{Cayley/pure mix})
}{T8'.8,T8'.8A1,T8'.8A2}

\ProofBlock{T8'.9: $\Delta_{\mathcal{T}}(f)$}{
\Delta_{\mathcal{T}}(f)\ \eqdef\ \mathbb{E}_{\Phi\sim\mu}\ \mathbb{E}_{(X,Y)\sim\mathcal{D}}\ \big\| z_f(\Phi\!\cdot\!X)-z_f(X)\big\|_2
}{T8'.1,T8'.4}

\ProofBlock{T8'.10: Geom$\Rightarrow$IR}{
z'=U'z,\ z=Uz,\ \|z\|_2\le B_z\ \Rightarrow\ \|z'-z\|_2=\|(U'-U)z\|_2\le \|U'-U\|_2\,B_z\\
C_z \eqdef B_z\ \Rightarrow\ \Delta_{\mathcal{T}}(f)\ \le\ C_z\,\mathrm{IR}_{\mathrm{spec}}(f)
}{T8'.4,T0.9,T8'.7}

\ProofBlock{T8'.11: $R_{\mathrm{train}},\ R_{\mathcal{T}}$}{
R_{\mathrm{train}}(f)\ \eqdef\ \mathbb{E}_{(X,Y)\sim\mathcal{D}}\ \ell(\psi(z_f(X)),Y)\\
R_{\mathcal{T}}(f)\ \eqdef\ \mathbb{E}_{\Phi\sim\mu}\ \mathbb{E}_{(X,Y)\sim\mathcal{D}}\ \ell(\psi(z_f(\Phi\!\cdot\!X)),Y)
}{T8'.3,T8'.4,T8'.1}

\ProofBlock{T8'.12: Shift-Lipschitz}{
R_{\mathcal{T}}(f)-R_{\mathrm{train}}(f)\ \le\ L\,\Delta_{\mathcal{T}}(f)\ \le\ L C_z\,\mathrm{IR}_{\mathrm{spec}}(f)
}{T8'.3,T8'.10,T8'.11}

\ProofBlock{T8'.13: IR upper bound}{
\mathrm{IR}_{\mathrm{spec}}(f)\ \le\ C_{\mathrm{comm}} + C_{\mathrm{mix}}
}{T6'.11,T8'.7,T8'.8,T8'.8bis}

\ProofBlock{T8'.14: $c_{\mathcal{T}}(m)$ (noncommuting lower bound)}{
m<d_h/2,\ \exists a\neq b:\ [L_a,L_b]\neq 0\ \text{ on active block}\\
\exists \kappa_\mathcal{T}(m)>0:\ \mathbb{E}_{\Delta\sim\nu}\ \inf_{\|r\|_1\le R}\ \big\| R_{\mathrm{STR}}(r)^\top R_{\mathrm{STR}}(r+\Delta)-R_{\mathrm{STR}}(\Delta)\big\|_2\ \ge\ \kappa_\mathcal{T}(m)\\
\Rightarrow\ \inf_{f\in\mathcal{H}_{\mathrm{STRING}}}\ \mathrm{IR}_{\mathrm{spec}}(f)\ \ge\ c_{\mathcal{T}}(m),\quad c_{\mathcal{T}}(m)\eqdef \kappa_\mathcal{T}(m)
}{T2.10,T1.1,T6'.3,T8'.7,T8'.5bis}

\ProofBlock{T8'.15: Reachability}{
\forall \delta>0\ \exists f_\delta\in\mathcal{H}_{\mathrm{ESPR}}:\ \varepsilon_{\mathrm{comm}}\le \delta,\ \eta_{\mathrm{mix}}\le \delta\ \Rightarrow\ \mathrm{IR}_{\mathrm{spec}}(f_\delta)\ \le\ C_{\mathrm{comm}}(\delta)+C_{\mathrm{mix}}(\delta)\ \xrightarrow{\delta\to 0} 0
}{T6'.11,T8'.6,T8'.7,T8'.8}

\ProofBlock{T8'.16: Infimum gap}{
\inf_{f\in\mathcal{H}_{\mathrm{ESPR}}}\ R_{\mathcal{T}}(f)\ \le\ \inf_{f\in\mathcal{H}_{\mathrm{ESPR}}}\big(R_{\mathrm{train}}(f)+L C_z\,\mathrm{IR}_{\mathrm{spec}}(f)\big)\\
\le\ \inf_{f\in\mathcal{H}_{\mathrm{STRING}}}\big(R_{\mathrm{train}}(f)+L C_z\,\mathrm{IR}_{\mathrm{spec}}(f)\big)\ -\ L C_z\,c_{\mathcal{T}}(m)\\
\le\ \inf_{f\in\mathcal{H}_{\mathrm{STRING}}}\ R_{\mathcal{T}}(f)\ -\ L C_z\,c_{\mathcal{T}}(m)
}{T8'.12,T8'.14,T8'.15,T8'.6}

\ProofBlock{T8'.17: Optimization (PL)}{
\exists \mu>0,\ L_g>0:\ \forall H\in\{\mathcal{H}_{\mathrm{STRING}},\mathcal{H}_{\mathrm{ESPR}}\},\ \mathcal{L}_H(f)\eqdef \widehat R_{\mathrm{train}}(f)+\lambda\,\mathrm{IR}_{\mathrm{spec}}(f)\\
\tfrac12\|\nabla \mathcal{L}_H(f)\|_2^2\ \ge\ \mu\big(\mathcal{L}_H(f)-\inf_{g\in H}\mathcal{L}_H(g)\big),\ \ \nabla\mathcal{L}_H\ \text{ is }L_g\text{-Lipschitz}\\
\Rightarrow\ \hat f_{\lambda,H}\in\arg\min_{f\in H}\mathcal{L}_H(f)
}{T8'.7,T0.12}

\ProofBlock{T8'.18: $\mathfrak{C}_n(H,\delta)$ (Rademacher; scaling)}{
\exists S_0,\tilde c>0:\ \mathfrak{C}_n(H,\delta)\ \eqdef\ c\Big(\frac{S(H)}{\sqrt{n}}+\sqrt{\frac{\log(1/\delta)}{n}}\Big),\ c\in\mathcal{C}\\
S(\mathcal{H}_{\mathrm{STRING}})\le S_0,\quad S(\mathcal{H}_{\mathrm{ESPR}})\ \le\ S_0 + \tilde c\cdot \big(\mathrm{rank}(E)+\varepsilon_{\mathrm{comm}}\big)\,g(d_h),\ \ g(d_h)\eqdef 2m
}{T0.12,T2.10}

\ProofBlock{T8'.19: Uniform gen}{
\Pr\Big[\ \forall f\in H:\ R_{\mathrm{train}}(f)\ \le\ \widehat R_{\mathrm{train}}(f)+\mathfrak{C}_n(H,\delta)\ \Big]\ \ge\ 1-\delta
}{T8'.18}

\ProofBlock{T8'.20: Shift risk (uniform)}{
\Pr\Big[\ \forall f\in H:\ R_{\mathcal{T}}(f)\ \le\ \widehat R_{\mathrm{train}}(f)+\mathfrak{C}_n(H,\delta)+L C_z\,\mathrm{IR}_{\mathrm{spec}}(f)\ \Big]\ \ge\ 1-\delta
}{T8'.12,T8'.19}

\ProofBlock{T8'.21: Achieved OOD gap}{
\epsilon_0 \eqdef L C_z\,c_{\mathcal{T}}(m),\quad \Delta_{\mathrm{gen}}\eqdef \mathfrak{C}_n(\mathcal{H}_{\mathrm{ESPR}},\delta)-\mathfrak{C}_n(\mathcal{H}_{\mathrm{STRING}},\delta)\\
\Pr\Big[\ R_{\mathcal{T}}(\hat f_{\lambda,\mathcal{H}_{\mathrm{ESPR}}})\ \le\ R_{\mathcal{T}}(\hat f_{\lambda,\mathcal{H}_{\mathrm{STRING}}})\ -\ \epsilon_0\ +\ \Delta_{\mathrm{gen}}\ \Big]\ \ge\ 1-\delta
}{T8'.16,T8'.17,T8'.20,T8'.6,T8'.18}

\ProofBlock{T8'.22: Worst-case}{
R_{\sup}(f)\ \eqdef\ \sup_{\Phi\in\mathcal{T}}\ \mathbb{E}_{(X,Y)\sim\mathcal{D}}\ \ell(\psi(z_f(\Phi\!\cdot\!X)),Y)\\
R_{\sup}(f)-R_{\mathrm{train}}(f)\ \le\ L C_z\,\sup_{\Delta\in\mathrm{supp}(\nu)}\ \sup_{\|r\|_1\le R}\ \big\|\Pi_{\mathrm{act}}R_{\mathrm{sp}}(r)^\top R_{\mathrm{sp}}(r+\Delta)\Pi_{\mathrm{act}}-\Pi_{\mathrm{act}}R_{\mathrm{STR}}(\Delta)\Pi_{\mathrm{act}}\big\|_2\\
\text{and }\sup_{\Phi\in\mathcal{T}}=\sup_{\Delta\in\mathrm{supp}(\nu)}\ \text{by T8'.1bis}
}{T8'.12,T8'.7,T8'.1bis}

\ProofBlock{T8'.23: Commuting sharpness}{
\forall \Delta\in\mathrm{supp}(\nu):\ [L_a,L_b]=0\ \wedge\ P_{\mathrm{sp}}\in\mathcal{A}\ \Rightarrow\ \mathrm{IR}_{\mathrm{spec}}(f)=0\\
\Rightarrow\ c_{\mathcal{T}}(m)=0,\ \epsilon_0=0
}{T3.4,T2.9,T8'.7,T8'.14}

\ProofBlock{T8'.24: Monotonicity of $\mathrm{IR}_{\mathrm{spec}}$}{
\eta_{\mathrm{mix}}\le \eta'_{\mathrm{mix}},\ \varepsilon_{\mathrm{comm}}\le \varepsilon'_{\mathrm{comm}}\\
\ \Rightarrow\ C_{\mathrm{mix}}\le C'_{\mathrm{mix}},\ C_{\mathrm{comm}}\le C'_{\mathrm{comm}}\\
\ \Rightarrow\ \mathrm{IR}_{\mathrm{spec}}(f)\ \le\ \mathrm{IR}'_{\mathrm{spec}}(f)
}{T8'.13,T8'.8}

\ProofBlock{T8'.25: Capacity crossover $m^\star$}{
\Delta_{\mathrm{gen}}(m)\ \le\ k\,\frac{\big(\mathrm{rank}(E)+\varepsilon_{\mathrm{comm}}\big)\,2m}{\sqrt{n}},\qquad
B(m)\ \eqdef\ L C_z\,c_{\mathcal{T}}(m).\\
\text{Assume } c_{\mathcal{T}}(m)\ \text{is nondecreasing in }m.\ \ \exists\, m^\star:\ 
B(m^\star)=\frac{2k\big(\mathrm{rank}(E)+\varepsilon_{\mathrm{comm}}\big)}{\sqrt{n}}\,m^\star.\\
\text{Then for } m\ge m^\star:\quad
B(m)>\Delta_{\mathrm{gen}}(m)\ \Rightarrow\
R_{\mathcal{T}}(\hat f_{\lambda,\mathcal{H}_{\mathrm{ESPR}}})\ <
R_{\mathcal{T}}(\hat f_{\lambda,\mathcal{H}_{\mathrm{STRING}}})\ \text{ w.h.p.}\\
\text{Equivalently, } 
 m^\star \ \text{is the fixed point}\ 
 m^\star\ =\ \frac{L C_z\,c_{\mathcal{T}}(m^\star)}{2k\big(\mathrm{rank}(E)+\varepsilon_{\mathrm{comm}}\big)}\,\sqrt{n}.
}{T8'.21,T8'.18,T8'.14}

\ProofBlock{T8'.26: Capacity-aware schedules (one-liner)}{
\exists c_1,c_2,c_3>0:\ \ \eta_{\mathrm{mix}}(m)\ \le\ c_1\,m^{-1/2},\quad \varepsilon_{\mathrm{comm}}(m)\ \le\ c_2\,m^{-1},\quad \|S(m)\|_2 \ \le\ 1-\frac{c_3}{m}\\
\Rightarrow\ C_{\mathrm{mix}}=O(1),\ \ C_{\mathrm{comm}}=\exp\!\big(O(R/m)\big)\cdot O\!\big((R+R_\Delta)^2/m\big)\ \ (\text{tame as }m\downarrow)
}{T8'.8c,T6'.6,T8'.8A2,T8'.8A1}

\end{document}
